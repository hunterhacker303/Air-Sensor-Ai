<div class="max-w-4xl mx-auto space-y-8">

    <h1 class="text-3xl font-bold text-gray-900 dark:text-white tracking-tight">
        System Status
    </h1>

    <!-- MAIN STATUS CARD -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">

        <div
            class="md:col-span-3 bg-white dark:bg-neutral-900 border border-gray-200 dark:border-neutral-800 p-8 flex items-center justify-between">

            <div>
                <div class="text-sm text-gray-500 uppercase tracking-widest mb-1">
                    Device ID: ESP32-AQM-001
                </div>

                <!-- device data -->
                <h1>Live ESP32 Sensor Data</h1>

                <!-- <p><strong>Raw:</strong> <span id="raw">loading...</span></p>
<p><strong>Voltage:</strong> <span id="voltage">loading...</span></p> -->
                <p><strong>Base PPM:</strong> <span id="base_ppm">loading...</span></p>
                <p><strong>AQI:</strong> <span id="aqi">loading...</span></p>
                <p><strong>Category:</strong> <span id="category">loading...</span></p>

                <div class="flex items-center gap-3">
                    <div class="w-4 h-4 rounded-full 
                        {% if status.status == 'online' %}
                            bg-green-500 animate-pulse
                        {% else %}
                            bg-red-500
                        {% endif %}
                    ">
                    </div>

                    <span class="text-3xl font-bold uppercase">
                        {{ status.status }}
                    </span>
                </div>
            </div>

            <div class="text-right">
                <div class="text-gray-500 text-sm">Last Seen</div>
                <div class="font-mono text-xl">{{ status.lastSeen }}</div>
            </div>
        </div>

        <!-- CONNECTIVITY -->
        <div class="bg-white dark:bg-neutral-900 border border-gray-200 dark:border-neutral-800 p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-bold flex items-center gap-2">
                    <!-- Wifi Icon -->
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" viewBox="0 0 24 24">
                        <path d="M5 12a7 7 0 0 1 14 0" />
                        <path d="M8.5 15.5a3.5 3.5 0 0 1 7 0" />
                        <path d="M12 18h.01" />
                    </svg>
                    Connectivity
                </h3>
                <span class="text-green-500 font-mono">{{ status.signalStrength }} dBm</span>
            </div>

            <div class="w-full bg-gray-200 dark:bg-neutral-700 h-2">
                <div class="bg-green-500 h-2" style="width: 80%;"></div>
            </div>
        </div>

        <!-- BATTERY -->
        <div class="bg-white dark:bg-neutral-900 border border-gray-200 dark:border-neutral-800 p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-bold flex items-center gap-2">
                    <!-- Battery Icon -->
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" viewBox="0 0 24 24">
                        <rect x="1" y="6" width="18" height="12" rx="2" />
                        <path d="M23 10v4" />
                    </svg>
                    Power
                </h3>
                <span class="text-indigo-500 font-mono">{{ status.battery }}%</span>
            </div>

            <div class="w-full bg-gray-200 dark:bg-neutral-700 h-2">
                <div class="bg-indigo-500 h-2" style="width: {{ status.battery }}%;"></div>
            </div>
        </div>

        <!-- STORAGE -->
        <div class="bg-white dark:bg-neutral-900 border border-gray-200 dark:border-neutral-800 p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-bold flex items-center gap-2">
                    <!-- Server Icon -->
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" viewBox="0 0 24 24">
                        <rect x="2" y="3" width="20" height="6" rx="2" />
                        <rect x="2" y="15" width="20" height="6" rx="2" />
                    </svg>
                    Storage
                </h3>
                <span class="text-blue-500 font-mono">45%</span>
            </div>

            <div class="w-full bg-gray-200 dark:bg-neutral-700 h-2">
                <div class="bg-blue-500 h-2" style="width: 45%;"></div>
            </div>
        </div>
    </div>

    <!-- SENSOR DIAGNOSTICS -->
    <div class="bg-white dark:bg-neutral-900 border border-gray-200 dark:border-neutral-800 p-8">
        <h3 class="font-bold mb-6 flex items-center gap-2 border-b border-gray-200 dark:border-neutral-700 pb-4">
            <!-- CPU Icon -->
            <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round" viewBox="0 0 24 24">
                <rect x="4" y="4" width="16" height="16" rx="2" />
                <path d="M9 9h6v6H9z" />
                <path d="M9 1v3M15 1v3M9 20v3M15 20v3M1 9h3M1 15h3M20 9h3M20 15h3" />
            </svg>
            Sensor Diagnostics
        </h3>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">

            <!-- PM SENSOR -->
            <div class="flex items-center justify-between">
                <span class="font-mono">SDS011 (PM)</span>
                {% if status.sensorStatus.pm %}
                <svg class="w-6 h-6 text-green-500" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                    <path d="M9 12l2 2 4-4" />
                    <circle cx="12" cy="12" r="10" />
                </svg>
                {% else %}
                <svg class="w-6 h-6 text-red-500" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="10" />
                    <line x1="15" y1="9" x2="9" y2="15" />
                    <line x1="9" y1="9" x2="15" y2="15" />
                </svg>
                {% endif %}
            </div>

            <!-- BME280 -->
            <div class="flex items-center justify-between">
                <span class="font-mono">BME280 (Env)</span>
                {% if status.sensorStatus.voc %}
                <svg class="w-6 h-6 text-green-500" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                    <path d="M9 12l2 2 4-4" />
                    <circle cx="12" cy="12" r="10" />
                </svg>
                {% else %}
                <svg class="w-6 h-6 text-red-500" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="10" />
                    <line x1="15" y1="9" x2="9" y2="15" />
                    <line x1="9" y1="9" x2="15" y2="15" />
                </svg>
                {% endif %}
            </div>

            <!-- CCS811 -->
            <div class="flex items-center justify-between">
                <span class="font-mono">CCS811 (VOC)</span>
                {% if status.sensorStatus.dht %}
                <svg class="w-6 h-6 text-green-500" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                    <path d="M9 12l2 2 4-4" />
                    <circle cx="12" cy="12" r="10" />
                </svg>
                {% else %}
                <svg class="w-6 h-6 text-red-500" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="10" />
                    <line x1="15" y1="9" x2="9" y2="15" />
                    <line x1="9" y1="9" x2="15" y2="15" />
                </svg>
                {% endif %}
            </div>

        </div>
    </div>

</div>
<script>
async function loadData() {
    const res = await fetch("/api/esp32");
    const data = await res.json();

    // document.getElementById("raw").innerText = data.raw;
    // document.getElementById("voltage").innerText = data.voltage;
    document.getElementById("base_ppm").innerText = data.base_ppm;
    document.getElementById("aqi").innerText = data.aqi;
    document.getElementById("category").innerText = data.category;
}

setInterval(loadData, 1000);
loadData();
</script>